const facile = [
    { nom: "ahki", nomComplet: "Pita AHKI", image: "images/ahki.png", poste: "centre"},
    { nom: "ainuu", nomComplet: "David AINU’U", image: "images/ainuu.png", poste: "pilier"},
    { nom: "aldegheri", nomComplet: "Dorian ALDEGHERI", image: "images/aldegheri.png", poste: "pilier"},
    { nom: "arnold", nomComplet: "Ritchie ARNOLD", image: "images/arnold.png", poste: "deuxieme"},
    { nom: "baille", nomComplet: "Cyril BAILLE", image: "images/baille.png", poste: "pilier"},
    { nom: "barassi", nomComplet: "Pierre-Louis BARASSI", image: "images/barassi.png", poste: "centre"},
    { nom: "brennan", nomComplet: "Joshua BRENNAN", image: "images/brennan.png", poste: "deuxieme"},
    { nom: "capuozzo", nomComplet: "Ange CAPUOZZO", image: "images/capuozzo.png", poste: "arriere"},
    { nom: "chocobares", nomComplet: "Santiago CHOCOBARES", image: "images/chocobares.png", poste: "centre"},
    { nom: "cramont", nomComplet: "Guillaume CRAMONT", image: "images/cramont.png", poste: "talonneur"},
    { nom: "cros", nomComplet: "François CROS", image: "images/cros.png", poste: "troisieme"},
    { nom: "delibes", nomComplet: "Dimitri DELIBES", image: "images/delibes.png", poste: "ailier"},
    { nom: "dupont", nomComplet: "Antoine DUPONT", image: "images/dupont.png", poste: "melee"},
    { nom: "duprat", nomComplet: "Maxime DUPRAT", image: "images/duprat.png", poste: "pilier"},
    { nom: "faasalele", nomComplet: "Piula FAASALELE", image: "images/faasalele.png", poste: "deuxieme"},
    { nom: "flament", nomComplet: "Thibaud FLAMENT", image: "images/flament.png", poste: "deuxieme"},
    { nom: "germain", nomComplet: "Baptiste GERMAIN", image: "images/germain.png", poste: "melee"},
    { nom: "graou", nomComplet: "Paul GRAOU", image: "images/graou.png", poste: "melee"},
    { nom: "guitoune", nomComplet: "Sofiane GUITOUNE", image: "images/guitoune.png", poste: "centre"},
    { nom: "jelonch", nomComplet: "Anthony JELONCH", image: "images/jelonch.png", poste: "troisieme"},
    { nom: "kinghorn", nomComplet: "Blair Kinghorn", image: "images/kinghorn.png", poste: "arriere"},
    { nom: "lebel", nomComplet: "Matthis LEBEL", image: "images/lebel.png", poste: "ailier"},
    { nom: "mallia", nomComplet: "Juan Cruz MALLÍA", image: "images/mallia.png", poste: "arriere"},
    { nom: "marchand", nomComplet: "Julien MARCHAND", image: "images/marchand.png", poste: "talonneur"},
    { nom: "mauvaka", nomComplet: "Peato MAUVAKA", image: "images/mauvaka.png", poste: "talonneur"},
    { nom: "meafou", nomComplet: "Emmanuel MEAFOU", image: "images/meafou.png", poste: "deuxieme"},
    { nom: "neti", nomComplet: "Rodrigue NETI", image: "images/neti.png", poste: "pilier"},
    { nom: "rntamack", nomComplet: "Romain NTAMACK", image: "images/rntamack.png", poste: "ouverture"},
    { nom: "tntamack", nomComplet: "Théo NTAMACK", image: "images/tntamack.png", poste: "troisieme"},
    { nom: "placines", nomComplet: "Alban PLACINES", image: "images/placines.png", poste: "troisieme"},
    { nom: "ramos", nomComplet: "Thomas RAMOS", image: "images/ramos.png", poste: "arriere"},
    { nom: "aretiere", nomComplet: "Arthur RETIÈRE", image: "images/aretiere.png", poste: "ailier"},
    { nom: "roumat", nomComplet: "Alexandre ROUMAT", image: "images/roumat.png", poste: "troisieme"},
    { nom: "tauzin", nomComplet: "Lucas TAUZIN", image: "images/tauzin.png", poste: "ailier"},
    { nom: "willis", nomComplet: "Jack WILLIS", image: "images/willis.png", poste: "troisieme"},
];

const moyen = [
    { nom: "auriac", nomComplet: "Max AURIAC", image: "images/auriac.png", poste: "arriere"},
    { nom: "bainivalu", nomComplet: "Eto BAINIVALU", image: "images/bainivalu.png", poste: "ailier"},
    { nom: "banos", nomComplet: "Leo BANOS", image: "images/banos.png", poste: "troisieme"},
    { nom: "bituniyata", nomComplet: "Setareki BITUNIYATA", image: "images/bituniyata.png", poste: "ailier"},
    { nom: "boubila", nomComplet: "Ian BOUBILA", image: "images/boubila.png", poste: "talonneur"},
    { nom: "castroferreira", nomComplet: "Mathis CASTROFERREIRA", image: "images/castroferreira.png", poste: "troisieme"},
    { nom: "costes", nomComplet: "Paul COSTES", image: "images/costes.png", poste: "centre"},
    { nom: "delpy", nomComplet: "Valentin DELPY", image: "images/delpy.png", poste: "ouverture"},
    { nom: "epee", nomComplet: "Nelson ÉPÉE", image: "images/epee.png", poste: "ailier"},
    { nom: "gourgues", nomComplet: "Kalvin Gourgues", image: "images/gourgues.png", poste: "ouverture"},
    { nom: "hawkes", nomComplet: "Malachi HAWKES", image: "images/hawkes.png", poste: "pilier"},
    { nom: "laulala", nomComplet: "Nepo LAULALA", image: "images/laulala.png", poste: "pilier"},
    { nom: "mallez", nomComplet: "Paul Mallez", image: "images/mallez.png", poste:"pilier"},
    { nom: "merkler", nomComplet: "Joel MERKLER", image: "images/merkler.png", poste: "pilier"},
    { nom: "reilhes", nomComplet: "Hugo REILHES", image: "images/reilhes.png", poste: "pilier"},
    { nom: "renda", nomComplet: "Simon RENDA", image: "images/renda.png", poste: "centre"},
    { nom: "eretiere", nomComplet: "Edgar RETIÈRE", image: "images/eretiere.png", poste: "ouverture"},
    { nom: "verge", nomComplet: "Clement VERGÉ", image: "images/verge.png", poste: "deuxieme"},

];

const difficile = [...facile, ...moyen];

var nombreTotalpersos;
var personnages;
var personnageAleatoire;
var personnagePoste;
var selectBulles = zone.querySelectorAll(".bulle");
var selectBoutons = zone.querySelectorAll(".bouton");
var boutonErreur
var animErreur = zone.querySelector("#divCentre");
var nombreTrouve = 0;
var nombreReussite = 0;
var reussiteActuelle = 1;
var pourcentage = 0;
var compteurSecondes = 0;
var secondesAffichees;
var compteurMinutes = 0;
var minutesAffichees;
var intervalCompteur;
var sonVictoire = document.getElementById('sonVictoire');
var sonEchec = document.getElementById('sonEchec');
var sonSuivant = document.getElementById('sonSuivant');
var pourcentageReussite;
var inversion;
var timeout1;
var timeout2;
var timeout3;
var timeout4;
var timeout5;
cacherBullesEtBoutons();
animationSousTexte();

barreComplete.style.opacity = '0';
setTimeout(function() {
    barreComplete.style.opacity = '1';
    score.style.transform = 'translateX(0)'
    compteurID.style.transform = 'translateX(0)'
}, 10)


function cacherBullesEtBoutons () {
    for (var i = 0; i < selectBulles.length; i++) {
    selectBulles[i].style.display = "none";
    }
    for (var i = 0; i < selectBoutons.length; i++) {
    selectBoutons[i].style.display = "none";
    }
}

function montrerBullesEtBoutons () {
    for (var i = 0; i < selectBulles.length; i++) {
    selectBulles[i].style.display = "block";
    }
    for (var i = 0; i < selectBoutons.length; i++) {
    selectBoutons[i].style.display = "inline";
    }
}

function retourIndex () {
    window.location.href = "index.html";
}

function retourMenu () {
    rejouer();
    arreterCompteur();
    boutonRetour.onclick = retourIndex;
    nomJoueur.textContent = '';
}

function incrementerCompteur () {
    compteurSecondes++;
    if (compteurSecondes == 60) {
        compteurMinutes++;
        compteurSecondes = 0;
    }
    secondesAffichees = compteurSecondes.toString().padStart(2, "0");
    minutesAffichees = compteurMinutes.toString().padStart(2, "0");
    compteurID.innerHTML = `<b>temps</b>   ${minutesAffichees} : ${secondesAffichees}`;
}

function lancerCompteur () {
    compteurMinutes = 0;
    compteurSecondes = 0;
    intervalCompteur = setInterval(incrementerCompteur,1000);
}
function arreterCompteur () {
    clearInterval(intervalCompteur);
}

function nouveauPerso () {
    personnageAleatoire = personnages[Math.floor(Math.random() * personnages.length)];
    personnagePoste = personnageAleatoire.poste;
    imagePerso.src = personnageAleatoire.image;
    personnageAleatoireNom = personnageAleatoire.nomComplet;
    nomJoueur.textContent = personnageAleatoireNom;
}

function animerErreur () {
    texteAffiche.textContent = "Mauvaise réponse...";
    texteAffiche.style.transform = 'scale(1.2)';
    divCentre.style.transform = 'translateX(-3px)';
    setTimeout(function() {
        divCentre.style.transform = 'translateX(0px)';
    }, 50)
    setTimeout(function() {
        divCentre.style.transform = 'translateX(2px)';
        texteAffiche.style.transform = 'scale(0.9)';
    }, 100)
    setTimeout(function() {
        divCentre.style.transform = 'translateX(0px)';
    }, 150)
    setTimeout(function() {
        divCentre.style.transform = 'translateX(-1px)';
    }, 200)
    setTimeout(function() {
        divCentre.style.transform = 'translateX(0px)';
        texteAffiche.style.transform = 'scale(1.0)';
    }, 250)

    for (var i = 0; i < boutonErreur.length; i++) {
    boutonErreur[i].style.opacity = "0.4";
    boutonErreur[i].style.textDecoration = "line-through";
        animErreur.classList.remove("animErreur");
        animErreur.classList.remove("animErreurDeux");
        animErreur.classList.add("classTerrain");
    setTimeout(function() {
        animErreur.classList.remove("classTerrain");
        animErreur.classList.add("animErreur");
    }, 10)
    setTimeout(function() {
        animErreur.classList.add("animErreurDeux");
    }, 200);
    }
}

function resetAnimation () {
    animErreur.classList.remove("animErreur");
    animErreur.classList.remove("animErreurDeux");
    animErreur.classList.add("classTerrain");
}

function animationSousTexte () {
boutonFacile.addEventListener('mouseover', () => {
  sousTexte.innerHTML = `Joueurs les plus connus<br><b>(ayant joué 10 matchs ou plus à Toulouse lors d'une saison)</b>`
  sousTexte.style.opacity = '1';
});

boutonFacile.addEventListener('mouseout', () => {
  sousTexte.style.opacity = '0';
});

boutonMoyen.addEventListener('mouseover', () => {
  sousTexte.innerHTML = `Joueurs moins connus<br><b>(ayant joué moins de 10 matchs à Toulouse lors d'une saison)</b>`
  sousTexte.style.opacity = '1';
});

boutonMoyen.addEventListener('mouseout', () => {
  sousTexte.style.opacity = '0';
});

boutonDifficile.addEventListener('mouseover', () => {
  sousTexte.innerHTML = `Tous les joueurs`
  sousTexte.style.opacity = '1';
});

boutonDifficile.addEventListener('mouseout', () => {
  sousTexte.style.opacity = '0';
});
}

function resetOpacity () {
    for (var i = 0; i < selectBulles.length; i++) {
        selectBulles[i].style.opacity = "1";
        selectBulles[i].style.textDecoration = "none";
        }
        for (var i = 0; i < selectBoutons.length; i++) {
        selectBoutons[i].style.opacity = "1";
        selectBoutons[i].style.textDecoration = "none";
        }
}

function lancerFacile() {
    personnages = [...facile];
    lancerCompteur();
    nouveauPerso();
    montrerBullesEtBoutons ()
    divMenu.style.display = 'none';
    totalPersoAffiche.innerHTML = facile.length;
    nombreTotalpersos = facile.length;
    nombrePersoAffiche.innerHTML = 0;
    divBoutons.style.opacity = '1';
    divBoutons.style.transform = 'scale(1.0)';
    divDroite.style.opacity = '1';
    divDroite.style.transform = 'translateX(0)';
    boutonRetour.onclick = retourMenu;
}

function lancerMoyen() {
    personnages = [...moyen];
    lancerCompteur();
    nouveauPerso();
    montrerBullesEtBoutons ()
    divMenu.style.display = 'none';
    nombrePersoAffiche.innerHTML = 0;
    totalPersoAffiche.innerHTML = moyen.length;
    nombreTotalpersos = moyen.length;
    divBoutons.style.opacity = '1';
    divBoutons.style.transform = 'scale(1.0)';
    divDroite.style.opacity = '1';
    divDroite.style.transform = 'translateX(0)';
    boutonRetour.onclick = retourMenu;
}

function lancerDifficile() {
    personnages = [...difficile];
    lancerCompteur();
    nouveauPerso();
    montrerBullesEtBoutons ()
    divMenu.style.display = 'none';
    nombrePersoAffiche.innerHTML = 0;
    totalPersoAffiche.innerHTML = difficile.length;
    nombreTotalpersos = difficile.length;
    divBoutons.style.opacity = '1';
    divBoutons.style.transform = 'scale(1.0)';
    divDroite.style.opacity = '1';
    divDroite.style.transform = 'translateX(0)';
    boutonRetour.onclick = retourMenu;
}



function rejouer () {
    divMenu.style.display = 'block';
    nombreTrouve = 0;
    nombreReussite = 0;
    reussiteActuelle = 1;
    nombrePersoAffiche.innerHTML = '00';
    totalPersoAffiche.innerHTML = '00';
    texteAffiche.textContent = "";
    score.innerHTML = `<b>score</b>   0 / 0`;
    compteurID.innerHTML = `<b>temps</b>   00 : 00`;
    nombrePersoAffiche.innerHTML = nombreTrouve;
    barrePourcentage.style.width = "0" ;
    divCentre.style.display = 'block';
    divDroite.style.display = 'block';
    divGauche.style.display = 'block';
    divReussite.style.display = 'none';
    imageCoupe.style.transform = 'scale(1.4)';
    imageCoupe.style.opacity = '0';
    imagePerso.src = 'images/imageDepart.png';
    cacherBullesEtBoutons();
    animationSousTexte();
    divBoutons.style.opacity = '0';
    divBoutons.style.transform = 'scale(1.2)';
    divDroite.style.opacity = '0';
    divDroite.style.transform = 'translateX(30px)';
    barrePourcentageReussite.style.width = '98%';
    barreReussite.style.display = 'none';
    pourcentageReussiteAffiche.style.right = '20px';
    barreReussite.style.opacity = '0';
    clearTimeout(timeout1);
    clearTimeout(timeout2);
    clearTimeout(timeout3);
    clearTimeout(timeout4);
    clearTimeout(timeout5);
}

function lancerGuess (classBouton) {
    if (personnagePoste == classBouton && personnages.length == 1) {
        nombreTrouve++;
        nombreReussite = nombreReussite + reussiteActuelle;
        texteAffiche.textContent = '';
        nomJoueur.textContent = '';
        divCentre.style.display = 'none';
        divDroite.style.display = 'none';
        divGauche.style.display = 'none';
        divReussite.style.display = 'block';
        arreterCompteur();
        resetOpacity();
        
        timeout1 = setTimeout(function() {
            imageCoupe.style.transform = 'scale(1.0)';
            imageCoupe.style.opacity = '1';
        },20)
        timeout2 = setTimeout(function() {
            barreReussite.style.opacity = '1';
        },800)
        
        divBoutonRejouer.innerHTML = `<button id="boutonRejouer" class="boutonBleu" onclick="rejouer()">Rejouer</button>`;
        sonVictoire.play();
        pourcentageReussite = nombreReussite * 100 / nombreTotalpersos;
        inversion = 100 - pourcentageReussite;
        barreReussite.style.display = 'flex';
        var entier = Math.round(pourcentageReussite);
        texteReussite.style.opacity = '0';
        texteReussite.innerHTML = '';
        pourcentageReussiteAffiche.textContent = entier + "%";
        timeout3 = setTimeout(function() {
            barrePourcentageReussite.style.width = inversion + "%";
        },1200)
        timeout4 = setTimeout(function() {
            pourcentageReussiteAffiche.style.right = '-55px';
        },2000)
        timeout5 = setTimeout(function() {
            texteReussite.style.opacity = '1';
            texteReussite.innerHTML = `Tu as <strong>${entier}%</strong> de bonnes réponses (<strong>${nombreReussite}/${nombreTrouve}</strong>).<br>
        Ton temps est de <strong>${compteurMinutes}</strong> minutes et <strong>${compteurSecondes}</strong> secondes.`;
        }, 3200);


    } else if (personnagePoste == classBouton) {
        sonSuivant.play();
        texteAffiche.textContent = "";
        resetAnimation();
        resetOpacity();
        for (var i = 0; i < personnages.length; i++) {
            if (personnages[i]["nomComplet"] == personnageAleatoireNom) {
                personnages.splice(i, 1);
            }
        }
        nombreTrouve++;
        nombreReussite = nombreReussite + reussiteActuelle;
        reussiteActuelle = 1;
        nouveauPerso();
    
    } else {
        boutonErreur = zone.querySelectorAll("." + classBouton);
        animerErreur ();
        reussiteActuelle = 0;
        sonEchec.play();
    }
    score.innerHTML = `<b>score</b>   ${nombreReussite} / ${nombreTrouve}`;
    pourcentage = nombreTrouve * 100 / nombreTotalpersos;
    barrePourcentage.style.width = pourcentage + "%";
    nombrePersoAffiche.innerHTML = nombreTrouve;
}
